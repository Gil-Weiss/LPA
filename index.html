<!DOCTYPE html>

<html lang="en">
    <head>
        <meta charset="utf-8" />
        <title>Light Programming Interface</title>
        <link rel="stylesheet" href="css/StyleSheet.css">
        <!-- All these are for tool tipster -->
        <link rel="stylesheet" type="text/css" href="css/tooltipster.css" />
        <link rel="stylesheet" type="text/css" href="css/tooltipster-shadow.css" />
        <link rel="stylesheet" media="screen" href="css/jquery.handsontable.full.min.css">
        <script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
        <script type="text/javascript" src="js/jquery.tooltipster.min.js"></script>
    </head>
    <body>
        <div>
            <p id="header">
            <a href="http://www.taborlab.rice.edu/" target="_blank" ><span id="labpage">LPI: Tabor lab</span></a>
            <span id="contact">Contact: 
                <a href="mailto:felixekness@gmail.com">Felix Ekness, </a>
                <a href="mailto:lhartsough@gmail.com">Lucas Hartsough, </a>
                <a href="mailto:brian.landry@gmail.com">Brian Landry</a> 
                
            </span>
            </p>
        </div>
        <div id="container">
            <form method="post" id="LPFform" class="LPFform">
                <fieldset>
                    <p class="legend">Light Device Specifications</p>
                    <ol id="LDSpecs">
                        <li id="devicesli">
                            <select id = "devices" name="devices">
                                <option value = "TCA">Two Color Array</option>
                                <option value = "LPA">Light Plate Apparatus</option>
                                <option value = "LTA">Light Tube Array</option>
                                <option value = "OGS">OptoGeneSat</option>
                                <option value="custom">Custom Configuration</option>
                            </select>
                        </li>
                        <li><label for="rows">Number of rows</label><input id="rows" type="number" name="rows" value="8" min ="1" step="1" required aria-required=”true” onchange="updateRCValidation()"/></li>
                        <li><label for="columns">Number of columns</label><input id="columns" type="number" name="columns" value="8" min="1" step="1" required aria-required=”true” onchange="updateRCValidation()"/></li>
                        <li><label for="LEDnum">Number of LEDs</label><input id="LEDnum" type ="number" name="LEDnum" value="1" min="1" step="1" required aria-required=”true”/></li>
                        <li>
                            <fieldset>
                                <p class="legend">LED Specifications</p>
                                <ol id="LEDs">
                                    <li class="template">
                                        <label  for="LED">Wavelength</label> <input class="LED" type="number" name="wavelength" value="0" min="0" max="1000" required aria-required=”true” width="30px"/>
                                        <div class="LEDDisplay" style="display: inline"> with sim color: <input type="color" style="width: 20px; height: 20px;"/></div>
                                    </li>
                                </ol>
                            </fieldset>
                        </li>
                    </ol>
                </fieldset>
                <fieldset>
                    <p class="legend">Light Program Specifications</p>
                    <ol id="LPSpecs">
                        <li><label for="length">Length of run (minutes)</label><input id="length" class='' type="number" name="length" min="0" value="480" max="1440" required aria-required=”true” onchange="updateLengthValidation()"/></li> <!-- onblur="updateTest()" -->
                        <li><label for="timestep">Timestep of run (seconds)</label><input id="timestep" type ="number" name="timestep" min="0" step="0.001" value="1" required aria-required=”true”/></li>
                        <li><label for="randomized">Randomize the positions</label><input id="randomized" type="checkbox" name="randomized" value="randomized"/></li>
                        <li><label for="offSwitch">Turn off LEDs upon finish</label><input id="offSwitch" type="checkbox" name="offSwitch" value="off"/></li>
                    </ol>
                    <ol id="wGroups">
                        <fieldset class="wGroup template">
                            <p class="legend">Waveform Group</p>
                            <ol>
                                <li class="wButtons">
                                    <input class="constButt" type="button"/>
                                    <input class="stepButt" type="button"/>
                                    <input class="sineButt" type="button"/>
                                    <input class="arbButt" type="button"/>
                                </li>
                                <li>
                                    <ol class="funcList">
                                    </ol>
                                </li>
                                <li><label class="samples"># of evenly spaced samples to take</label><input class="samples" type="number" value="1" min="1" step="1" required aria-required=”true"/></li>
                                <li><label class="replicates"># of Replicates</label><input class="replicates" type="number" value="1" min="1" step="1" required aria-required=”true"/></li>
                                <li><label class="startTime">First timepoint</label><input class="startTime" type="number" value="0" min="0"/></li>
                                <li><label class="CSVTimepoints">CSV timepoints</label><input class="CSVTimepoints" type="text" /></li>
                            </ol>
                        </fieldset>
                        <fieldset class="func const template">
                            <div class="wrapper"> <!-- Temporary, fixes strange on minimized border rendering bug -->
                                <div class="legend">Constant Input Function</div>
                                <div class="minimize" title="Minimize Function"></div>
                                <div class="maximize" title="Maximize Function"></div>
                                <div class="minClose" title="Close Function"></div>
                            </div>
                            <ol>
                                <li><input class="funcType" type="text" value="constant" style="display: none"/></li>
                                <li><label class="funcWavelength">For wavelength</label>
                                    <select class ="funcWavelength">
                                    </select>
                                </li>
                                <li><label class="ints">Comma seperated list of intensities</label><input class="ints" type="text" placeholder="0,50,100,4095" pattern="[\[|\{|\(]?((?:40(?:5[0-9]|[0-9][0-5])|1[0-9]{3}|2[0-9]{3}|3[0-9]{3}|[0-9][0-9]{0,2}) *, *)*(?:40(?:5[0-9]|[0-9][0-5])|1[0-9]{3}|2[0-9]{3}|3[0-9]{3}|[0-9][0-9]{0,2})[\]|\}|\)]?"  title="Int1, Int2, ...  in [0,4095]"/></li>
                                <!-- REGEX FOR ANY POSITIVE INTEGER INPUT (NOT LIMITED TO 4095 MAX):
                                <li><label class="ints">Comma seperated list of intensities</label><input class="ints" type="text" placeholder="0,50,100,4095" pattern="[\[|\{|\(]?(\d+ *, *)*\d+[\]|\}|\)]?"  title="Int1, Int2, ..."/></li>
                                -->
                                <li><input class="close" type = "button" value="Close"/></li>
                            </ol>
                        </fieldset>
                        <fieldset class="func step template">
                            <div class="wrapper"> <!-- Temporary, fixes strange on minimized border rendering bug -->
                                <div class="legend">Step Input Function</div>
                                <div class="minimize" title="Minimize Function"></div>
                                <div class="maximize" title="Maximize Function"></div>
                                <div class="minClose" title="Close Function"></div>
                            </div>
                            <ol>
                                <li><input class="funcType" type="text" value="step" style="display: none"/></li>
                                <li>
                                    <label for="funcWavelength">For wavelength</label>  
                                    <select class = "funcWavelength" name="funcWavelength"></select>
                                </li>
                                <li><label class="amplitudes">Comma separated list of amplitudes</label><input class="amplitudes" type="text" placeholder="0,50,100,4095" pattern="[\[|\{|\(]?-?((?:40(?:5[0-9]|[0-9][0-5])|1[0-9]{3}|2[0-9]{3}|3[0-9]{3}|[0-9][0-9]{0,2}) *, *-?)*(?:40(?:5[0-9]|[0-9][0-5])|1[0-9]{3}|2[0-9]{3}|3[0-9]{3}|[0-9][0-9]{0,2})[\]|\}|\)]?"  title="Int1, Int2, ...  in [0,4095]"/></li>
                                <li><label class="offset">Step Offset (GS)</label><input class="offset" type="number" value="0" min="0" step="1" max="4095" required aria-required=”true”/></li>
                                <li><label class="stepTime">Time into run at which step occurs</label><input class="stepTime" type="number" value="0" min="0" step="0.001" required aria-required=”true”/></li>
                                <li>
                                    <label><b>Sign</b></label><br/>
                                    <input class="stepUp" type="radio" checked="checked" value="stepUp"/><label class="stepUp">Step Up</label>
                                    <input class="stepDown" type="radio" value="stepDown"/><label class="stepDown">Step Down</label>
                                </li>
                                <li><input class="close" type ="button" value="Close"/></li>
                            </ol>
                        </fieldset>
                        <fieldset class="func sine template">
                            <div class="wrapper"> <!-- Temporary, fixes strange on minimized border rendering bug -->
                                <div class="legend">Sine Wave Input Function</div>
                                <div class="minimize" title="Minimize Function"></div>
                                <div class="maximize" title="Maximize Function"></div>
                                <div class="minClose" title="Close Function"></div>
                            </div>
                            <ol>
                                <li><input class="funcType" type="text" value="sine" style="display: none"/></li>
                                <li><label  for="funcWavelength">For wavelength</label>
                                    <select class = "funcWavelength" name="funcWavelength">
                                    </select>
                                </li>
                                <li><label class="amplitude">Amplitude of Wave</label><input class="amplitude" type="number" value="2047" min="0" max="4095" required aria-required=”true"/></li>
                                <li><label class="period">Period of Wave (minutes)</label><input class="period" type="number" value="480" min="0" required aria-required=”true"/></li>
                                <li><label class="phase">Phase of Wave (minutes)</label><input class="phase" type="number" value="0" min="0" required aria-required=”true"/></li>
                                <li><label class="offset">Verticle offset of Wave</label><input class="offset" type="number" value="2047" min="0" max="4095" required aria-required=”true"/></li>
                                <li><input class="close" type ="button" value="Close"/></li>
                            </ol>
                        </fieldset>
                        <fieldset class="func arb template">
                            <div class="wrapper"> <!-- Temporary, fixes strange on minimized border rendering bug -->
                                <div class="legend">Arbitrary Input Function</div>
                                <div class="minimize" title="Minimize Function"></div>
                                <div class="maximize" title="Maximize Function"></div>
                                <div class="minClose" title="Close Function"></div>
                            </div>
                            <ol>
                                <li><input class="funcType" type="text" value="arb" style="display: none"/></li>
                                <li><label class="funcWavelength">For wavelength</label>
                                    <select class ="funcWavelength">
                                    </select>
                                </li>
                                <li><div class="arbTable"></div></li>
                                <input class="close" type = "button" value="Close"/></li>
                            </ol>
                        </fieldset>
                    </ol>
                    <input id="addWGroup" type="button" value="Add Waveform Group"/>
                </fieldset>
                <fieldset>
                    <table><input type="submit" id="submit" value="Load Simulation"/>
                    <div id="download">Download</div></table>
                </fieldset>
            </form>
            <div id="visualization">
                <div id="control">
                    <div id="controlInput">
                        <select id="LEDdisplay" style="padding-left: 5px">   
                        </select>
                        <input type ="button" id="view" value ="Well View" style="width: 80px;"/>
                        <div id="wellIndex" style="display: inline">
                            <div id="Row" style="display: inline">&nbsp;Row: <span id="WellRow"> 1 </span> </div>
                            <div id="Col" style="display: inline">Col: <span id="WellCol"> 1 </span> </div>
                        </div>
                        <div id="wellIndex2" style="display: inline">
                            <div id="Index" style="display: inline">&nbsp;Well &#35;: <span id="WellInd"> 1 </span> </div>
                        </div>
                        <label for="speed" class="plate">&nbsp;Speed</label><input id="speed" class="plate" type="range" min="0" max="1" step="0.01" value="0.5"/>
                        <input id="play" class="plate"type="button" value="Play" style="width: 50px;"/>
                        <div id="displayTime" class="plate">00:00:00</div>
                    </div>
                    <div id="timerInput">
                        <input id="time" class="plate" type="range" min="0" max="1" step="0.001" value="0" />
                    </div>
                </div>
                <div id="simulation">
                    <div id="plateSim" class="plate">
                        <canvas id="canvas"></canvas>
                    </div>
                    <div id="wellSim" class="well">
                    </div>
                </div>
            </div> 
        </div>
        <script src="js/jquery.handsontable.full.min.js"></script>
        <script src="js/canvasjs.min.js"></script>
        <script src="js/papaparse.min.js"></script>
        <script src="lib/numeric-1.2.6.js"></script>
        <script src="lib/jszip.min.js"></script>
        <script src="js/plate.js"></script>
        <script src="js/LPI.js"></script>
        <script src="js/FileSaver.js"></script>
    </body>
</html>
